---
title: "R Notebook"
output: 
  html_document:
    keep_md: true
    code_folding: show
    df_print: paged
---



# sfourspec R Package

*Simple Fourier Spectra*.

Utilities to make simple spectrum analysis. Simple tools for simple spectral analysis based on Fourier signal decomposition.


## Install

```
remotes::install_github("https://github.com/miguel-conde/sfourspec.git",ref = "develop")
```

## Example


```r
library(sfourspec)

air_pass <- tibble(t = 1:length(AirPassengers), pass = as.numeric(AirPassengers))

plot(AirPassengers)
```

![](index_files/figure-html/unnamed-chunk-1-1.png)<!-- -->


```r
lm_air_pass <- lm(pass ~ t, air_pass)

detrended_air_pass <- AirPassengers - fitted(lm_air_pass)

plot(detrended_air_pass)
```

![](index_files/figure-html/unnamed-chunk-2-1.png)<!-- -->


```r
N <- length(detrended_air_pass)
ns <- 0:(N-1)

spec_x <- spectral_analysis(detrended_air_pass)
```


```r
spec_x$four_exp
```

<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["n"],"name":[1],"type":["int"],"align":["right"]},{"label":["k"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["w_k"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["f_k"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["T_k"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["x_k"],"name":[6],"type":["cpl"],"align":["right"]},{"label":["a_k"],"name":[7],"type":["cpl"],"align":["right"]},{"label":["F_L_spectrum_k"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["periodogram_k"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"0","2":"0","3":"0.00000000","4":"0.000000000","5":"Inf","6":"-1.563194e-13+0.000000e+00i","7":"-1.085551e-15+0.000000e+00i","8":"1.178422e-30","9":"682.2071"},{"1":"1","2":"1","3":"0.04363323","4":"0.006944444","5":"144.000000","6":"1.046350e+03+1.386145e+02i","7":"7.266317e+00+9.626009e-01i","8":"5.372596e+01","9":"3229.4381"},{"1":"2","2":"2","3":"0.08726646","4":"0.013888889","5":"72.000000","6":"1.432021e+02-2.831886e+02i","7":"9.944592e-01-1.966587e+00i","8":"4.856414e+00","9":"930.8140"},{"1":"3","2":"3","3":"0.13089969","4":"0.020833333","5":"48.000000","6":"7.089111e+02+3.068144e+02i","7":"4.922994e+00+2.130655e+00i","8":"2.877556e+01","9":"2207.5832"},{"1":"4","2":"4","3":"0.17453293","4":"0.027777778","5":"36.000000","6":"5.424048e+01+1.362451e+02i","7":"3.766700e-01+9.461465e-01i","8":"1.037073e+00","9":"731.5718"},{"1":"5","2":"5","3":"0.21816616","4":"0.034722222","5":"28.800000","6":"-2.210595e+01+2.624557e+02i","7":"-1.535135e-01+1.822609e+00i","8":"3.345471e+00","9":"977.6089"},{"1":"6","2":"6","3":"0.26179939","4":"0.041666667","5":"24.000000","6":"9.742574e+01-1.616053e+02i","7":"6.765677e-01-1.122259e+00i","8":"1.717209e+00","9":"1040.3977"},{"1":"7","2":"7","3":"0.30543262","4":"0.048611111","5":"20.571429","6":"5.649926e+01+1.257040e+01i","7":"3.923560e-01+8.729442e-02i","8":"1.615635e-01","9":"1463.2251"},{"1":"8","2":"8","3":"0.34906585","4":"0.055555556","5":"18.000000","6":"5.627856e+01+2.943154e+02i","7":"3.908234e-01+2.043857e+00i","8":"4.330093e+00","9":"2176.5434"},{"1":"9","2":"9","3":"0.39269908","4":"0.062500000","5":"16.000000","6":"-4.886278e+01+1.268701e+02i","7":"-3.393249e-01+8.810422e-01i","8":"8.913768e-01","9":"2759.2631"},{"1":"10","2":"10","3":"0.43633231","4":"0.069444444","5":"14.400000","6":"2.018355e+01+3.723095e+02i","7":"1.401635e-01+2.585483e+00i","8":"6.704366e+00","9":"4893.8329"},{"1":"11","2":"11","3":"0.47996554","4":"0.076388889","5":"13.090909","6":"-4.735612e+01+1.042084e+03i","7":"-3.288620e-01+7.236695e+00i","8":"5.247790e+01","9":"11347.5271"},{"1":"12","2":"12","3":"0.52359878","4":"0.083333333","5":"12.000000","6":"-3.275439e+03-3.926537e+02i","7":"-2.274611e+01-2.726762e+00i","8":"5.248206e+02","9":"25586.9124"},{"1":"13","2":"13","3":"0.56723201","4":"0.090277778","5":"11.076923","6":"-2.355029e+02-1.046542e+03i","7":"-1.635437e+00-7.267656e+00i","8":"5.549348e+01","9":"10331.4601"},{"1":"14","2":"14","3":"0.61086524","4":"0.097222222","5":"10.285714","6":"-5.188817e+01-5.557509e+02i","7":"-3.603345e-01-3.859382e+00i","8":"1.502467e+01","9":"5492.3004"},{"1":"15","2":"15","3":"0.65449847","4":"0.104166667","5":"9.600000","6":"3.174975e+01-3.419567e+02i","7":"2.204843e-01-2.374700e+00i","8":"5.687811e+00","9":"3830.5516"},{"1":"16","2":"16","3":"0.69813170","4":"0.111111111","5":"9.000000","6":"5.544191e+00-2.530670e+02i","7":"3.850133e-02-1.757410e+00i","8":"3.089971e+00","9":"2838.8727"},{"1":"17","2":"17","3":"0.74176493","4":"0.118055556","5":"8.470588","6":"-3.028204e+01-3.205542e+02i","7":"-2.102920e-01-2.226071e+00i","8":"4.999615e+00","9":"2307.4192"},{"1":"18","2":"18","3":"0.78539816","4":"0.125000000","5":"8.000000","6":"-4.040206e+01-3.997350e+02i","7":"-2.805699e-01-2.775937e+00i","8":"7.784547e+00","9":"1983.6328"},{"1":"19","2":"19","3":"0.82903139","4":"0.131944444","5":"7.578947","6":"-1.403721e+01-2.580755e+02i","7":"-9.748065e-02-1.792191e+00i","8":"3.221452e+00","9":"1578.9544"},{"1":"20","2":"20","3":"0.87266463","4":"0.138888889","5":"7.200000","6":"1.200627e+02-1.910219e+02i","7":"8.337684e-01-1.326541e+00i","8":"2.454881e+00","9":"1403.1187"},{"1":"21","2":"21","3":"0.91629786","4":"0.145833333","5":"6.857143","6":"-2.980386e+01-2.470121e+02i","7":"-2.069713e-01-1.715362e+00i","8":"2.985303e+00","9":"1029.5109"},{"1":"22","2":"22","3":"0.95993109","4":"0.152777778","5":"6.545455","6":"-3.400373e+01-1.995103e+02i","7":"-2.361370e-01-1.385488e+00i","8":"1.975338e+00","9":"774.9928"},{"1":"23","2":"23","3":"1.00356432","4":"0.159722222","5":"6.260870","6":"-5.977093e+01-6.280370e+02i","7":"-4.150759e-01-4.361368e+00i","8":"1.919382e+01","9":"1882.7737"},{"1":"24","2":"24","3":"1.04719755","4":"0.166666667","5":"6.000000","6":"1.398317e+03-1.167952e+03i","7":"9.710536e+00-8.110776e+00i","8":"1.600792e+02","9":"8204.7150"},{"1":"25","2":"25","3":"1.09083078","4":"0.173611111","5":"5.760000","6":"3.043682e+02+3.365094e+02i","7":"2.113668e+00+2.336871e+00i","8":"9.928558e+00","9":"4306.7818"},{"1":"26","2":"26","3":"1.13446401","4":"0.180555556","5":"5.538462","6":"8.656586e+01+1.165144e+02i","7":"6.011518e-01+8.091278e-01i","8":"1.016071e+00","9":"2603.3753"},{"1":"27","2":"27","3":"1.17809725","4":"0.187500000","5":"5.333333","6":"2.550487e+01+1.272658e+02i","7":"1.771172e-01+8.837905e-01i","8":"8.124561e-01","9":"2091.1427"},{"1":"28","2":"28","3":"1.22173048","4":"0.194444444","5":"5.142857","6":"8.665867e+01+2.561734e+01i","7":"6.017963e-01+1.778982e-01i","8":"3.938066e-01","9":"1715.9213"},{"1":"29","2":"29","3":"1.26536371","4":"0.201388889","5":"4.965517","6":"2.535543e+01+4.446618e-01i","7":"1.760794e-01+3.087929e-03i","8":"3.101349e-02","9":"1522.4200"},{"1":"30","2":"30","3":"1.30899694","4":"0.208333333","5":"4.800000","6":"8.130424e+00+3.032019e+01i","7":"5.646127e-02+2.105569e-01i","8":"4.752207e-02","9":"1382.4285"},{"1":"31","2":"31","3":"1.35263017","4":"0.215277778","5":"4.645161","6":"1.148415e+02-5.660021e+01i","7":"7.975101e-01-3.930570e-01i","8":"7.905163e-01","9":"1274.0490"},{"1":"32","2":"32","3":"1.39626340","4":"0.222222222","5":"4.500000","6":"1.047536e+02-1.337856e+02i","7":"7.274559e-01-9.290665e-01i","8":"1.392357e+00","9":"1161.5980"},{"1":"33","2":"33","3":"1.43989663","4":"0.229166667","5":"4.363636","6":"9.444142e+01-4.455454e+01i","7":"6.558432e-01-3.094065e-01i","8":"5.258627e-01","9":"1076.2942"},{"1":"34","2":"34","3":"1.48352986","4":"0.236111111","5":"4.235294","6":"1.999853e+02+1.358269e+01i","7":"1.388787e+00+9.432422e-02i","8":"1.937627e+00","9":"1032.0986"},{"1":"35","2":"35","3":"1.52716310","4":"0.243055556","5":"4.114286","6":"2.203942e+02+9.570770e+01i","7":"1.530515e+00+6.646368e-01i","8":"2.784219e+00","9":"927.6346"},{"1":"36","2":"36","3":"1.57079633","4":"0.250000000","5":"4.000000","6":"-2.686828e+02+6.096828e+02i","7":"-1.865852e+00+4.233908e+00i","8":"2.140738e+01","9":"1971.1113"},{"1":"37","2":"37","3":"1.61442956","4":"0.256944444","5":"3.891892","6":"-1.219352e+02-7.389926e+01i","7":"-8.467721e-01-5.131893e-01i","8":"9.803862e-01","9":"1374.4122"},{"1":"38","2":"38","3":"1.65806279","4":"0.263888889","5":"3.789474","6":"-8.268881e+01-2.862263e+01i","7":"-5.742278e-01-1.987683e-01i","8":"3.692464e-01","9":"1132.0683"},{"1":"39","2":"39","3":"1.70169602","4":"0.270833333","5":"3.692308","6":"5.105705e+00-1.094623e+01i","7":"3.545628e-02-7.601551e-02i","8":"7.035505e-03","9":"1041.9524"},{"1":"40","2":"40","3":"1.74532925","4":"0.277777778","5":"3.600000","6":"-3.391115e+01-6.211201e+01i","7":"-2.354941e-01-4.313334e-01i","8":"2.415060e-01","9":"993.3654"},{"1":"41","2":"41","3":"1.78896248","4":"0.284722222","5":"3.512195","6":"-1.813118e+01-3.536280e+01i","7":"-1.259110e-01-2.455750e-01i","8":"7.616066e-02","9":"939.3199"},{"1":"42","2":"42","3":"1.83259571","4":"0.291666667","5":"3.428571","6":"2.261433e+01-7.151873e+01i","7":"1.570440e-01-4.966579e-01i","8":"2.713318e-01","9":"916.0819"},{"1":"43","2":"43","3":"1.87622895","4":"0.298611111","5":"3.348837","6":"3.649381e+01-1.020136e+02i","7":"2.534292e-01-7.084275e-01i","8":"5.660959e-01","9":"892.2234"},{"1":"44","2":"44","3":"1.91986218","4":"0.305555556","5":"3.272727","6":"5.149461e+01-8.960247e+01i","7":"3.576015e-01-6.222394e-01i","8":"5.150606e-01","9":"857.4548"},{"1":"45","2":"45","3":"1.96349541","4":"0.312500000","5":"3.200000","6":"5.070736e+00-6.246126e+01i","7":"3.521345e-02-4.337587e-01i","8":"1.893866e-01","9":"806.6766"},{"1":"46","2":"46","3":"2.00712864","4":"0.319444444","5":"3.130435","6":"6.745984e+01-1.026945e+02i","7":"4.684711e-01-7.131560e-01i","8":"7.280568e-01","9":"790.9445"},{"1":"47","2":"47","3":"2.05076187","4":"0.326388889","5":"3.063830","6":"1.229201e+02-2.190755e+02i","7":"8.536118e-01-1.521358e+00i","8":"3.043182e+00","9":"827.7308"},{"1":"48","2":"48","3":"2.09439510","4":"0.333333333","5":"3.000000","6":"2.913172e+02+4.645838e+02i","7":"2.023036e+00+3.226276e+00i","8":"1.450154e+01","9":"1554.5205"},{"1":"49","2":"49","3":"2.13802833","4":"0.340277778","5":"2.938776","6":"-8.583276e+00-9.914743e+00i","7":"-5.960608e-02-6.885239e-02i","8":"8.293536e-03","9":"922.5153"},{"1":"50","2":"50","3":"2.18166156","4":"0.347222222","5":"2.880000","6":"2.150011e+02+3.735722e+01i","7":"1.493063e+00+2.594251e-01i","8":"2.296539e+00","9":"919.1616"},{"1":"51","2":"51","3":"2.22529480","4":"0.354166667","5":"2.823529","6":"5.828387e+01+6.570711e+01i","7":"4.047491e-01+4.562994e-01i","8":"3.720310e-01","9":"833.0220"},{"1":"52","2":"52","3":"2.26892803","4":"0.361111111","5":"2.769231","6":"2.973587e+01+2.481010e+01i","7":"2.064991e-01+1.722924e-01i","8":"7.232655e-02","9":"795.9312"},{"1":"53","2":"53","3":"2.31256126","4":"0.368055556","5":"2.716981","6":"2.497653e+01+5.161820e+01i","7":"1.734481e-01+3.584597e-01i","8":"1.585776e-01","9":"779.2734"},{"1":"54","2":"54","3":"2.35619449","4":"0.375000000","5":"2.666667","6":"4.303654e+01+2.689951e+01i","7":"2.988649e-01+1.868022e-01i","8":"1.242153e-01","9":"757.8447"},{"1":"55","2":"55","3":"2.39982772","4":"0.381944444","5":"2.618182","6":"1.165598e+01+1.063275e+02i","7":"8.094434e-02+7.383852e-01i","8":"5.517647e-01","9":"764.7950"},{"1":"56","2":"56","3":"2.44346095","4":"0.388888889","5":"2.571429","6":"1.308431e+01+8.252934e+00i","7":"9.086323e-02+5.731204e-02i","8":"1.154080e-02","9":"731.6261"},{"1":"57","2":"57","3":"2.48709418","4":"0.395833333","5":"2.526316","6":"2.141366e+01+7.771685e+00i","7":"1.487059e-01+5.397003e-02i","8":"2.502622e-02","9":"716.0490"},{"1":"58","2":"58","3":"2.53072742","4":"0.402777778","5":"2.482759","6":"2.376044e+01-1.079457e+02i","7":"1.650030e-01-7.496232e-01i","8":"5.891609e-01","9":"727.2330"},{"1":"59","2":"59","3":"2.57436065","4":"0.409722222","5":"2.440678","6":"8.728093e+01-8.108706e+01i","7":"6.061176e-01-5.631046e-01i","8":"6.844653e-01","9":"714.7230"},{"1":"60","2":"60","3":"2.61799388","4":"0.416666667","5":"2.400000","6":"1.730738e+02+4.103848e+02i","7":"1.201902e+00+2.849894e+00i","8":"9.566464e+00","9":"1151.9563"},{"1":"61","2":"61","3":"2.66162711","4":"0.423611111","5":"2.360656","6":"-9.326821e+01+1.012945e+02i","7":"-6.476959e-01+7.034344e-01i","8":"9.143299e-01","9":"795.9156"},{"1":"62","2":"62","3":"2.70526034","4":"0.430555556","5":"2.322581","6":"-1.564527e+02+4.127628e+01i","7":"-1.086477e+00+2.866408e-01i","8":"1.262595e+00","9":"783.9255"},{"1":"63","2":"63","3":"2.74889357","4":"0.437500000","5":"2.285714","6":"1.155614e+01-7.758804e+01i","7":"8.025097e-02-5.388058e-01i","8":"2.967519e-01","9":"740.6299"},{"1":"64","2":"64","3":"2.79252680","4":"0.444444444","5":"2.250000","6":"-8.846110e+00-4.321483e+01i","7":"-6.143132e-02-3.001030e-01i","8":"9.383559e-02","9":"711.2166"},{"1":"65","2":"65","3":"2.83616003","4":"0.451388889","5":"2.215385","6":"2.811222e+01+3.458544e+01i","7":"1.952238e-01+2.401767e-01i","8":"9.579715e-02","9":"703.0478"},{"1":"66","2":"66","3":"2.87979327","4":"0.458333333","5":"2.181818","6":"5.109847e+01+7.477155e+01i","7":"3.548505e-01+5.192469e-01i","8":"3.955362e-01","9":"709.6389"},{"1":"67","2":"67","3":"2.92342650","4":"0.465277778","5":"2.149254","6":"2.916718e+01+5.716787e+01i","7":"2.025498e-01+3.969991e-01i","8":"1.986347e-01","9":"696.4488"},{"1":"68","2":"68","3":"2.96705973","4":"0.472222222","5":"2.117647","6":"-1.928884e+01-4.382532e+01i","7":"-1.339503e-01-3.043425e-01i","8":"1.105670e-01","9":"694.3315"},{"1":"69","2":"69","3":"3.01069296","4":"0.479166667","5":"2.086957","6":"-7.556375e+01+2.848935e+01i","7":"-5.247482e-01+1.978427e-01i","8":"3.145025e-01","9":"700.4744"},{"1":"70","2":"70","3":"3.05432619","4":"0.486111111","5":"2.057143","6":"4.682023e+00+2.354534e+01i","7":"3.251405e-02+1.635093e-01i","8":"2.779245e-02","9":"684.4802"},{"1":"71","2":"71","3":"3.09795942","4":"0.493055556","5":"2.028169","6":"-5.782808e+01+1.350802e+01i","7":"-4.015839e-01+9.380573e-02i","8":"1.700691e-01","9":"690.5565"},{"1":"72","2":"72","3":"3.14159265","4":"0.500000000","5":"2.000000","6":"-8.368276e+01+0.000000e+00i","7":"-5.811303e-01+0.000000e+00i","8":"3.377124e-01","9":"698.0672"},{"1":"73","2":"71","3":"3.09795942","4":"0.493055556","5":"2.028169","6":"-5.782808e+01-1.350802e+01i","7":"-4.015839e-01-9.380573e-02i","8":"1.700691e-01","9":"690.5565"},{"1":"74","2":"70","3":"3.05432619","4":"0.486111111","5":"2.057143","6":"4.682023e+00-2.354534e+01i","7":"3.251405e-02-1.635093e-01i","8":"2.779245e-02","9":"684.4802"},{"1":"75","2":"69","3":"3.01069296","4":"0.479166667","5":"2.086957","6":"-7.556375e+01-2.848935e+01i","7":"-5.247482e-01-1.978427e-01i","8":"3.145025e-01","9":"700.4744"},{"1":"76","2":"68","3":"2.96705973","4":"0.472222222","5":"2.117647","6":"-1.928884e+01+4.382532e+01i","7":"-1.339503e-01+3.043425e-01i","8":"1.105670e-01","9":"694.3315"},{"1":"77","2":"67","3":"2.92342650","4":"0.465277778","5":"2.149254","6":"2.916718e+01-5.716787e+01i","7":"2.025498e-01-3.969991e-01i","8":"1.986347e-01","9":"696.4488"},{"1":"78","2":"66","3":"2.87979327","4":"0.458333333","5":"2.181818","6":"5.109847e+01-7.477155e+01i","7":"3.548505e-01-5.192469e-01i","8":"3.955362e-01","9":"709.6389"},{"1":"79","2":"65","3":"2.83616003","4":"0.451388889","5":"2.215385","6":"2.811222e+01-3.458544e+01i","7":"1.952238e-01-2.401767e-01i","8":"9.579715e-02","9":"703.0478"},{"1":"80","2":"64","3":"2.79252680","4":"0.444444444","5":"2.250000","6":"-8.846110e+00+4.321483e+01i","7":"-6.143132e-02+3.001030e-01i","8":"9.383559e-02","9":"711.2166"},{"1":"81","2":"63","3":"2.74889357","4":"0.437500000","5":"2.285714","6":"1.155614e+01+7.758804e+01i","7":"8.025097e-02+5.388058e-01i","8":"2.967519e-01","9":"740.6299"},{"1":"82","2":"62","3":"2.70526034","4":"0.430555556","5":"2.322581","6":"-1.564527e+02-4.127628e+01i","7":"-1.086477e+00-2.866408e-01i","8":"1.262595e+00","9":"783.9255"},{"1":"83","2":"61","3":"2.66162711","4":"0.423611111","5":"2.360656","6":"-9.326821e+01-1.012945e+02i","7":"-6.476959e-01-7.034344e-01i","8":"9.143299e-01","9":"795.9156"},{"1":"84","2":"60","3":"2.61799388","4":"0.416666667","5":"2.400000","6":"1.730738e+02-4.103848e+02i","7":"1.201902e+00-2.849894e+00i","8":"9.566464e+00","9":"1151.9563"},{"1":"85","2":"59","3":"2.57436065","4":"0.409722222","5":"2.440678","6":"8.728093e+01+8.108706e+01i","7":"6.061176e-01+5.631046e-01i","8":"6.844653e-01","9":"714.7230"},{"1":"86","2":"58","3":"2.53072742","4":"0.402777778","5":"2.482759","6":"2.376044e+01+1.079457e+02i","7":"1.650030e-01+7.496232e-01i","8":"5.891609e-01","9":"727.2330"},{"1":"87","2":"57","3":"2.48709418","4":"0.395833333","5":"2.526316","6":"2.141366e+01-7.771685e+00i","7":"1.487059e-01-5.397003e-02i","8":"2.502622e-02","9":"716.0490"},{"1":"88","2":"56","3":"2.44346095","4":"0.388888889","5":"2.571429","6":"1.308431e+01-8.252934e+00i","7":"9.086323e-02-5.731204e-02i","8":"1.154080e-02","9":"731.6261"},{"1":"89","2":"55","3":"2.39982772","4":"0.381944444","5":"2.618182","6":"1.165598e+01-1.063275e+02i","7":"8.094434e-02-7.383852e-01i","8":"5.517647e-01","9":"764.7950"},{"1":"90","2":"54","3":"2.35619449","4":"0.375000000","5":"2.666667","6":"4.303654e+01-2.689951e+01i","7":"2.988649e-01-1.868022e-01i","8":"1.242153e-01","9":"757.8447"},{"1":"91","2":"53","3":"2.31256126","4":"0.368055556","5":"2.716981","6":"2.497653e+01-5.161820e+01i","7":"1.734481e-01-3.584597e-01i","8":"1.585776e-01","9":"779.2734"},{"1":"92","2":"52","3":"2.26892803","4":"0.361111111","5":"2.769231","6":"2.973587e+01-2.481010e+01i","7":"2.064991e-01-1.722924e-01i","8":"7.232655e-02","9":"795.9312"},{"1":"93","2":"51","3":"2.22529480","4":"0.354166667","5":"2.823529","6":"5.828387e+01-6.570711e+01i","7":"4.047491e-01-4.562994e-01i","8":"3.720310e-01","9":"833.0220"},{"1":"94","2":"50","3":"2.18166156","4":"0.347222222","5":"2.880000","6":"2.150011e+02-3.735722e+01i","7":"1.493063e+00-2.594251e-01i","8":"2.296539e+00","9":"919.1616"},{"1":"95","2":"49","3":"2.13802833","4":"0.340277778","5":"2.938776","6":"-8.583276e+00+9.914743e+00i","7":"-5.960608e-02+6.885239e-02i","8":"8.293536e-03","9":"922.5153"},{"1":"96","2":"48","3":"2.09439510","4":"0.333333333","5":"3.000000","6":"2.913172e+02-4.645838e+02i","7":"2.023036e+00-3.226276e+00i","8":"1.450154e+01","9":"1554.5205"},{"1":"97","2":"47","3":"2.05076187","4":"0.326388889","5":"3.063830","6":"1.229201e+02+2.190755e+02i","7":"8.536118e-01+1.521358e+00i","8":"3.043182e+00","9":"827.7308"},{"1":"98","2":"46","3":"2.00712864","4":"0.319444444","5":"3.130435","6":"6.745984e+01+1.026945e+02i","7":"4.684711e-01+7.131560e-01i","8":"7.280568e-01","9":"790.9445"},{"1":"99","2":"45","3":"1.96349541","4":"0.312500000","5":"3.200000","6":"5.070736e+00+6.246126e+01i","7":"3.521345e-02+4.337587e-01i","8":"1.893866e-01","9":"806.6766"},{"1":"100","2":"44","3":"1.91986218","4":"0.305555556","5":"3.272727","6":"5.149461e+01+8.960247e+01i","7":"3.576015e-01+6.222394e-01i","8":"5.150606e-01","9":"857.4548"},{"1":"101","2":"43","3":"1.87622895","4":"0.298611111","5":"3.348837","6":"3.649381e+01+1.020136e+02i","7":"2.534292e-01+7.084275e-01i","8":"5.660959e-01","9":"892.2234"},{"1":"102","2":"42","3":"1.83259571","4":"0.291666667","5":"3.428571","6":"2.261433e+01+7.151873e+01i","7":"1.570440e-01+4.966579e-01i","8":"2.713318e-01","9":"916.0819"},{"1":"103","2":"41","3":"1.78896248","4":"0.284722222","5":"3.512195","6":"-1.813118e+01+3.536280e+01i","7":"-1.259110e-01+2.455750e-01i","8":"7.616066e-02","9":"939.3199"},{"1":"104","2":"40","3":"1.74532925","4":"0.277777778","5":"3.600000","6":"-3.391115e+01+6.211201e+01i","7":"-2.354941e-01+4.313334e-01i","8":"2.415060e-01","9":"993.3654"},{"1":"105","2":"39","3":"1.70169602","4":"0.270833333","5":"3.692308","6":"5.105705e+00+1.094623e+01i","7":"3.545628e-02+7.601551e-02i","8":"7.035505e-03","9":"1041.9524"},{"1":"106","2":"38","3":"1.65806279","4":"0.263888889","5":"3.789474","6":"-8.268881e+01+2.862263e+01i","7":"-5.742278e-01+1.987683e-01i","8":"3.692464e-01","9":"1132.0683"},{"1":"107","2":"37","3":"1.61442956","4":"0.256944444","5":"3.891892","6":"-1.219352e+02+7.389926e+01i","7":"-8.467721e-01+5.131893e-01i","8":"9.803862e-01","9":"1374.4122"},{"1":"108","2":"36","3":"1.57079633","4":"0.250000000","5":"4.000000","6":"-2.686828e+02-6.096828e+02i","7":"-1.865852e+00-4.233908e+00i","8":"2.140738e+01","9":"1971.1113"},{"1":"109","2":"35","3":"1.52716310","4":"0.243055556","5":"4.114286","6":"2.203942e+02-9.570770e+01i","7":"1.530515e+00-6.646368e-01i","8":"2.784219e+00","9":"927.6346"},{"1":"110","2":"34","3":"1.48352986","4":"0.236111111","5":"4.235294","6":"1.999853e+02-1.358269e+01i","7":"1.388787e+00-9.432422e-02i","8":"1.937627e+00","9":"1032.0986"},{"1":"111","2":"33","3":"1.43989663","4":"0.229166667","5":"4.363636","6":"9.444142e+01+4.455454e+01i","7":"6.558432e-01+3.094065e-01i","8":"5.258627e-01","9":"1076.2942"},{"1":"112","2":"32","3":"1.39626340","4":"0.222222222","5":"4.500000","6":"1.047536e+02+1.337856e+02i","7":"7.274559e-01+9.290665e-01i","8":"1.392357e+00","9":"1161.5980"},{"1":"113","2":"31","3":"1.35263017","4":"0.215277778","5":"4.645161","6":"1.148415e+02+5.660021e+01i","7":"7.975101e-01+3.930570e-01i","8":"7.905163e-01","9":"1274.0490"},{"1":"114","2":"30","3":"1.30899694","4":"0.208333333","5":"4.800000","6":"8.130424e+00-3.032019e+01i","7":"5.646127e-02-2.105569e-01i","8":"4.752207e-02","9":"1382.4285"},{"1":"115","2":"29","3":"1.26536371","4":"0.201388889","5":"4.965517","6":"2.535543e+01-4.446618e-01i","7":"1.760794e-01-3.087929e-03i","8":"3.101349e-02","9":"1522.4200"},{"1":"116","2":"28","3":"1.22173048","4":"0.194444444","5":"5.142857","6":"8.665867e+01-2.561734e+01i","7":"6.017963e-01-1.778982e-01i","8":"3.938066e-01","9":"1715.9213"},{"1":"117","2":"27","3":"1.17809725","4":"0.187500000","5":"5.333333","6":"2.550487e+01-1.272658e+02i","7":"1.771172e-01-8.837905e-01i","8":"8.124561e-01","9":"2091.1427"},{"1":"118","2":"26","3":"1.13446401","4":"0.180555556","5":"5.538462","6":"8.656586e+01-1.165144e+02i","7":"6.011518e-01-8.091278e-01i","8":"1.016071e+00","9":"2603.3753"},{"1":"119","2":"25","3":"1.09083078","4":"0.173611111","5":"5.760000","6":"3.043682e+02-3.365094e+02i","7":"2.113668e+00-2.336871e+00i","8":"9.928558e+00","9":"4306.7818"},{"1":"120","2":"24","3":"1.04719755","4":"0.166666667","5":"6.000000","6":"1.398317e+03+1.167952e+03i","7":"9.710536e+00+8.110776e+00i","8":"1.600792e+02","9":"8204.7150"},{"1":"121","2":"23","3":"1.00356432","4":"0.159722222","5":"6.260870","6":"-5.977093e+01+6.280370e+02i","7":"-4.150759e-01+4.361368e+00i","8":"1.919382e+01","9":"1882.7737"},{"1":"122","2":"22","3":"0.95993109","4":"0.152777778","5":"6.545455","6":"-3.400373e+01+1.995103e+02i","7":"-2.361370e-01+1.385488e+00i","8":"1.975338e+00","9":"774.9928"},{"1":"123","2":"21","3":"0.91629786","4":"0.145833333","5":"6.857143","6":"-2.980386e+01+2.470121e+02i","7":"-2.069713e-01+1.715362e+00i","8":"2.985303e+00","9":"1029.5109"},{"1":"124","2":"20","3":"0.87266463","4":"0.138888889","5":"7.200000","6":"1.200627e+02+1.910219e+02i","7":"8.337684e-01+1.326541e+00i","8":"2.454881e+00","9":"1403.1187"},{"1":"125","2":"19","3":"0.82903139","4":"0.131944444","5":"7.578947","6":"-1.403721e+01+2.580755e+02i","7":"-9.748065e-02+1.792191e+00i","8":"3.221452e+00","9":"1578.9544"},{"1":"126","2":"18","3":"0.78539816","4":"0.125000000","5":"8.000000","6":"-4.040206e+01+3.997350e+02i","7":"-2.805699e-01+2.775937e+00i","8":"7.784547e+00","9":"1983.6328"},{"1":"127","2":"17","3":"0.74176493","4":"0.118055556","5":"8.470588","6":"-3.028204e+01+3.205542e+02i","7":"-2.102920e-01+2.226071e+00i","8":"4.999615e+00","9":"2307.4192"},{"1":"128","2":"16","3":"0.69813170","4":"0.111111111","5":"9.000000","6":"5.544191e+00+2.530670e+02i","7":"3.850133e-02+1.757410e+00i","8":"3.089971e+00","9":"2838.8727"},{"1":"129","2":"15","3":"0.65449847","4":"0.104166667","5":"9.600000","6":"3.174975e+01+3.419567e+02i","7":"2.204843e-01+2.374700e+00i","8":"5.687811e+00","9":"3830.5516"},{"1":"130","2":"14","3":"0.61086524","4":"0.097222222","5":"10.285714","6":"-5.188817e+01+5.557509e+02i","7":"-3.603345e-01+3.859382e+00i","8":"1.502467e+01","9":"5492.3004"},{"1":"131","2":"13","3":"0.56723201","4":"0.090277778","5":"11.076923","6":"-2.355029e+02+1.046542e+03i","7":"-1.635437e+00+7.267656e+00i","8":"5.549348e+01","9":"10331.4601"},{"1":"132","2":"12","3":"0.52359878","4":"0.083333333","5":"12.000000","6":"-3.275439e+03+3.926537e+02i","7":"-2.274611e+01+2.726762e+00i","8":"5.248206e+02","9":"25586.9124"},{"1":"133","2":"11","3":"0.47996554","4":"0.076388889","5":"13.090909","6":"-4.735612e+01-1.042084e+03i","7":"-3.288620e-01-7.236695e+00i","8":"5.247790e+01","9":"11347.5271"},{"1":"134","2":"10","3":"0.43633231","4":"0.069444444","5":"14.400000","6":"2.018355e+01-3.723095e+02i","7":"1.401635e-01-2.585483e+00i","8":"6.704366e+00","9":"4893.8329"},{"1":"135","2":"9","3":"0.39269908","4":"0.062500000","5":"16.000000","6":"-4.886278e+01-1.268701e+02i","7":"-3.393249e-01-8.810422e-01i","8":"8.913768e-01","9":"2759.2631"},{"1":"136","2":"8","3":"0.34906585","4":"0.055555556","5":"18.000000","6":"5.627856e+01-2.943154e+02i","7":"3.908234e-01-2.043857e+00i","8":"4.330093e+00","9":"2176.5434"},{"1":"137","2":"7","3":"0.30543262","4":"0.048611111","5":"20.571429","6":"5.649926e+01-1.257040e+01i","7":"3.923560e-01-8.729442e-02i","8":"1.615635e-01","9":"1463.2251"},{"1":"138","2":"6","3":"0.26179939","4":"0.041666667","5":"24.000000","6":"9.742574e+01+1.616053e+02i","7":"6.765677e-01+1.122259e+00i","8":"1.717209e+00","9":"1040.3977"},{"1":"139","2":"5","3":"0.21816616","4":"0.034722222","5":"28.800000","6":"-2.210595e+01-2.624557e+02i","7":"-1.535135e-01-1.822609e+00i","8":"3.345471e+00","9":"977.6089"},{"1":"140","2":"4","3":"0.17453293","4":"0.027777778","5":"36.000000","6":"5.424048e+01-1.362451e+02i","7":"3.766700e-01-9.461465e-01i","8":"1.037073e+00","9":"731.5718"},{"1":"141","2":"3","3":"0.13089969","4":"0.020833333","5":"48.000000","6":"7.089111e+02-3.068144e+02i","7":"4.922994e+00-2.130655e+00i","8":"2.877556e+01","9":"2207.5832"},{"1":"142","2":"2","3":"0.08726646","4":"0.013888889","5":"72.000000","6":"1.432021e+02+2.831886e+02i","7":"9.944592e-01+1.966587e+00i","8":"4.856414e+00","9":"930.8140"},{"1":"143","2":"1","3":"0.04363323","4":"0.006944444","5":"144.000000","6":"1.046350e+03-1.386145e+02i","7":"7.266317e+00-9.626009e-01i","8":"5.372596e+01","9":"3229.4381"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>


```r
plot(spec_x)
```

![](index_files/figure-html/unnamed-chunk-5-1.png)<!-- -->


```r
plot(spec_x, x_axis = "n")
```

![](index_files/figure-html/unnamed-chunk-6-1.png)<!-- -->


```r
plot(spec_x, y_axis = "periodogram")
```

![](index_files/figure-html/unnamed-chunk-7-1.png)<!-- -->


```r
plot(spec_x, x_axis = "T", y_axis = "periodogram", log = "xy")
```

![](index_files/figure-html/unnamed-chunk-8-1.png)<!-- -->


```r
rebuilt_x <- rebuild_signal(spec_x, threshold = 1)

plot(detrended_air_pass)
lines(rebuilt_x, col = "red")
```

![](index_files/figure-html/unnamed-chunk-9-1.png)<!-- -->



```r
rebuilt_x <- rebuild_signal(spec_x, threshold = 0.65)

plot(detrended_air_pass)
lines(rebuilt_x, col = "red")
```

![](index_files/figure-html/unnamed-chunk-10-1.png)<!-- -->




